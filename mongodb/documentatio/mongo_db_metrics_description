mongodb exporter

–ì—Ä—É–ø–ø–∏—Ä–æ–≤–∫–∞ –º–µ—Ç—Ä–∏–∫ MongoDB –¥–ª—è Grafana Dashboard
–ü–∞–Ω–µ–ª—å 1: –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –∏ –æ—Å–Ω–æ–≤–Ω—ã–µ –ø–æ–∫–∞–∑–∞—Ç–µ–ª–∏
1. collector_scrape_time_ms
–ï–¥–∏–Ω–∏—Ü–∞ –∏–∑–º–µ—Ä–µ–Ω–∏—è: –º–∏–ª–ª–∏—Å–µ–∫—É–Ω–¥—ã (ms)
–û–ø–∏—Å–∞–Ω–∏–µ: –í—Ä–µ–º—è —Å–±–æ—Ä–∞ –º–µ—Ç—Ä–∏–∫ —Ä–∞–∑–ª–∏—á–Ω—ã–º–∏ –∫–æ–ª–ª–µ–∫—Ç–æ—Ä–∞–º–∏. –í—ã—Å–æ–∫–∏–µ –∑–Ω–∞—á–µ–Ω–∏—è –º–æ–≥—É—Ç —É–∫–∞–∑—ã–≤–∞—Ç—å –Ω–∞ –ø—Ä–æ–±–ª–µ–º—ã –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ MongoDB –∏–ª–∏ —Å–µ—Ç–∏.
–ú–µ—Ç—Ä–∏–∫–∏:

collector_scrape_time_ms{collector="diagnostic_data"} - –æ—Å–æ–±–µ–Ω–Ω–æ –≤–∞–∂–Ω–æ, —Ç–∞–∫ –∫–∞–∫ –¥–∏–∞–≥–Ω–æ—Å—Ç–∏—á–µ—Å–∫–∏–µ –¥–∞–Ω–Ω—ã–µ —Ç—Ä–µ–±—É—é—Ç –≥–ª—É–±–æ–∫–æ–≥–æ –∞–Ω–∞–ª–∏–∑–∞

collector_scrape_time_ms{collector="top"} - –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –æ–ø–µ—Ä–∞—Ü–∏–π –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏

2. mongodb_asserts_total
–ï–¥–∏–Ω–∏—Ü–∞ –∏–∑–º–µ—Ä–µ–Ω–∏—è: –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ (count)
–û–ø–∏—Å–∞–Ω–∏–µ: –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —É—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–π (asserts) –≤ MongoDB. –í—ã—Å–æ–∫–∏–µ –∑–Ω–∞—á–µ–Ω–∏—è —É–∫–∞–∑—ã–≤–∞—é—Ç –Ω–∞ –≤–Ω—É—Ç—Ä–µ–Ω–Ω–∏–µ –æ—à–∏–±–∫–∏ –∏–ª–∏ –ø—Ä–æ–±–ª–µ–º—ã —Å –¥–∞–Ω–Ω—ã–º–∏.
–ö–ª—é—á–µ–≤–∞—è –º–µ—Ç—Ä–∏–∫–∞:

mongodb_asserts_total{type="user"} - –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–µ asserts (1.46M –≤ –ª–æ–≥–µ) - –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏ –≤–∞–∂–Ω–æ –æ—Ç—Å–ª–µ–∂–∏–≤–∞—Ç—å

3. mongodb_clusterTime_clusterTime
–ï–¥–∏–Ω–∏—Ü–∞ –∏–∑–º–µ—Ä–µ–Ω–∏—è: timestamp (—Å–µ–∫—É–Ω–¥—ã —Å —ç–ø–æ—Ö–∏ Unix)
–û–ø–∏—Å–∞–Ω–∏–µ: –í—Ä–µ–º—è –∫–ª–∞—Å—Ç–µ—Ä–∞ MongoDB, –≤–∞–∂–Ω–æ –¥–ª—è –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞ —Ä–µ–ø–ª–∏–∫–∞—Ü–∏–∏ –∏ —Å–æ–≥–ª–∞—Å–æ–≤–∞–Ω–Ω–æ—Å—Ç–∏ –¥–∞–Ω–Ω—ã—Ö.

–ü–∞–Ω–µ–ª—å 2: –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –ø–∞–º—è—Ç–∏ –∏ —Å–±–æ—Ä–∫–∞ –º—É—Å–æ—Ä–∞
4. go_memstats_heap_alloc_bytes
–ï–¥–∏–Ω–∏—Ü–∞ –∏–∑–º–µ—Ä–µ–Ω–∏—è: –±–∞–π—Ç—ã (bytes)
–û–ø–∏—Å–∞–Ω–∏–µ: –¢–µ–∫—É—â–µ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ heap-–ø–∞–º—è—Ç–∏ —ç–∫—Å–ø–æ—Ä—Ç–µ—Ä–æ–º. –†–µ–∑–∫–∏–π —Ä–æ—Å—Ç –º–æ–∂–µ—Ç —É–∫–∞–∑—ã–≤–∞—Ç—å –Ω–∞ —É—Ç–µ—á–∫—É –ø–∞–º—è—Ç–∏.

5. go_memstats_heap_inuse_bytes
–ï–¥–∏–Ω–∏—Ü–∞ –∏–∑–º–µ—Ä–µ–Ω–∏—è: –±–∞–π—Ç—ã (bytes)
–û–ø–∏—Å–∞–Ω–∏–µ: –†–∞–∑–º–µ—Ä heap-–ø–∞–º—è—Ç–∏, –∞–∫—Ç–∏–≤–Ω–æ –∏—Å–ø–æ–ª—å–∑—É–µ–º–æ–π —ç–∫—Å–ø–æ—Ä—Ç–µ—Ä–æ–º.

6. go_memstats_heap_idle_bytes
–ï–¥–∏–Ω–∏—Ü–∞ –∏–∑–º–µ—Ä–µ–Ω–∏—è: –±–∞–π—Ç—ã (bytes)
–û–ø–∏—Å–∞–Ω–∏–µ: –†–∞–∑–º–µ—Ä –Ω–µ–∏—Å–ø–æ–ª—å–∑—É–µ–º–æ–π heap-–ø–∞–º—è—Ç–∏, –∫–æ—Ç–æ—Ä–∞—è –º–æ–∂–µ—Ç –±—ã—Ç—å –≤–æ–∑–≤—Ä–∞—â–µ–Ω–∞ –û–°.

7. go_gc_duration_seconds
–ï–¥–∏–Ω–∏—Ü–∞ –∏–∑–º–µ—Ä–µ–Ω–∏—è: —Å–µ–∫—É–Ω–¥—ã (seconds)
–û–ø–∏—Å–∞–Ω–∏–µ: –í—Ä–µ–º—è, –∑–∞—Ç—Ä–∞—á–µ–Ω–Ω–æ–µ –Ω–∞ —Å–±–æ—Ä–∫—É –º—É—Å–æ—Ä–∞. –î–ª–∏—Ç–µ–ª—å–Ω—ã–µ –ø–∞—É–∑—ã GC –≤–ª–∏—è—é—Ç –Ω–∞ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å.
–ú–µ—Ç—Ä–∏–∫–∏:

go_gc_duration_seconds{quantile="1"} - –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–µ –≤—Ä–µ–º—è –ø–∞—É–∑—ã GC

go_gc_duration_seconds_sum - –æ–±—â–µ–µ –≤—Ä–µ–º—è, –ø–æ—Ç—Ä–∞—á–µ–Ω–Ω–æ–µ –Ω–∞ GC

–ü–∞–Ω–µ–ª—å 3: –ö—ç—à WiredTiger
8. mongodb_config_image_collection_stats_storageStats_indexDetails_id_cache_bytes_currently_in_the_cache
–ï–¥–∏–Ω–∏—Ü–∞ –∏–∑–º–µ—Ä–µ–Ω–∏—è: –±–∞–π—Ç—ã (bytes)
–û–ø–∏—Å–∞–Ω–∏–µ: –¢–µ–∫—É—â–∏–π —Ä–∞–∑–º–µ—Ä –¥–∞–Ω–Ω—ã—Ö –≤ –∫—ç—à–µ –¥–ª—è –∏–Ω–¥–µ–∫—Å–∞ id. –ù–∏–∑–∫–∏–µ –∑–Ω–∞—á–µ–Ω–∏—è –º–æ–≥—É—Ç —É–∫–∞–∑—ã–≤–∞—Ç—å –Ω–∞ –Ω–µ—Ö–≤–∞—Ç–∫—É –∫—ç—à–∞.

9. mongodb_config_image_collection_stats_storageStats_indexDetails_id_cache_pages_requested_from_the_cache
–ï–¥–∏–Ω–∏—Ü–∞ –∏–∑–º–µ—Ä–µ–Ω–∏—è: –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å—Ç—Ä–∞–Ω–∏—Ü (count)
–û–ø–∏—Å–∞–Ω–∏–µ: –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –∑–∞–ø—Ä–æ—Å–æ–≤ —Å—Ç—Ä–∞–Ω–∏—Ü –∏–∑ –∫—ç—à–∞. –í—ã—Å–æ–∫–∏–µ –∑–Ω–∞—á–µ–Ω–∏—è —É–∫–∞–∑—ã–≤–∞—é—Ç –Ω–∞ —Ö–æ—Ä–æ—à—É—é —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç—å –∫—ç—à–∞.

10. mongodb_config_image_collection_stats_storageStats_wiredTiger_cache_bytes_currently_in_the_cache
–ï–¥–∏–Ω–∏—Ü–∞ –∏–∑–º–µ—Ä–µ–Ω–∏—è: –±–∞–π—Ç—ã (bytes)
–û–ø–∏—Å–∞–Ω–∏–µ: –û–±—â–∏–π —Ä–∞–∑–º–µ—Ä –¥–∞–Ω–Ω—ã—Ö –≤ –∫—ç—à–µ WiredTiger. –ö–ª—é—á–µ–≤–æ–π –ø–æ–∫–∞–∑–∞—Ç–µ–ª—å —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏ –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏—è.

–ü–∞–Ω–µ–ª—å 4: –û–ø–µ—Ä–∞—Ü–∏–∏ —Å –∫—É—Ä—Å–æ—Ä–∞–º–∏
11. mongodb_config_image_collection_stats_storageStats_indexDetails_id_cursor_next_calls
–ï–¥–∏–Ω–∏—Ü–∞ –∏–∑–º–µ—Ä–µ–Ω–∏—è: –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –æ–ø–µ—Ä–∞—Ü–∏–π (count)
–û–ø–∏—Å–∞–Ω–∏–µ: –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –æ–ø–µ—Ä–∞—Ü–∏–π cursor.next(). –í—ã—Å–æ–∫–∏–µ –∑–Ω–∞—á–µ–Ω–∏—è –º–æ–≥—É—Ç —É–∫–∞–∑—ã–≤–∞—Ç—å –Ω–∞ –Ω–µ–æ–ø—Ç–∏–º–∞–ª—å–Ω—ã–µ –∑–∞–ø—Ä–æ—Å—ã.

12. mongodb_config_image_collection_stats_storageStats_indexDetails_id_cursor_reset_calls
–ï–¥–∏–Ω–∏—Ü–∞ –∏–∑–º–µ—Ä–µ–Ω–∏—è: –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –æ–ø–µ—Ä–∞—Ü–∏–π (count)
–û–ø–∏—Å–∞–Ω–∏–µ: –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å–±—Ä–æ—Å–æ–≤ –∫—É—Ä—Å–æ—Ä–æ–≤. –ú–æ–∂–µ—Ç —É–∫–∞–∑—ã–≤–∞—Ç—å –Ω–∞ –ø—Ä–æ–±–ª–µ–º—ã —Å —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ–º –∫—É—Ä—Å–æ—Ä–∞–º–∏.

13. mongodb_config_image_collection_stats_storageStats_indexDetails_id_cursor_cache_cursors_reuse_count
–ï–¥–∏–Ω–∏—Ü–∞ –∏–∑–º–µ—Ä–µ–Ω–∏—è: –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–π (count)
–û–ø–∏—Å–∞–Ω–∏–µ: –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–æ–≤—Ç–æ—Ä–Ω–æ–≥–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –∫—ç—à–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –∫—É—Ä—Å–æ—Ä–æ–≤. –í—ã—Å–æ–∫–∏–µ –∑–Ω–∞—á–µ–Ω–∏—è –ø–æ–∫–∞–∑—ã–≤–∞—é—Ç —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç—å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è —Ä–µ—Å—É—Ä—Å–æ–≤.

–ü–∞–Ω–µ–ª—å 5: –†–∞–∑–º–µ—Ä—ã –¥–∞–Ω–Ω—ã—Ö –∏ –∏–Ω–¥–µ–∫—Å–æ–≤
14. mongodb_config_image_collection_stats_storageStats_size
–ï–¥–∏–Ω–∏—Ü–∞ –∏–∑–º–µ—Ä–µ–Ω–∏—è: –±–∞–π—Ç—ã (bytes)
–û–ø–∏—Å–∞–Ω–∏–µ: –†–∞–∑–º–µ—Ä –¥–∞–Ω–Ω—ã—Ö –∫–æ–ª–ª–µ–∫—Ü–∏–∏. –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ —Ä–æ—Å—Ç–∞ –¥–∞–Ω–Ω—ã—Ö –≤–∞–∂–µ–Ω –¥–ª—è –ø–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏—è —Ä–µ—Å—É—Ä—Å–æ–≤.

15. mongodb_config_image_collection_stats_storageStats_storageSize
–ï–¥–∏–Ω–∏—Ü–∞ –∏–∑–º–µ—Ä–µ–Ω–∏—è: –±–∞–π—Ç—ã (bytes)
–û–ø–∏—Å–∞–Ω–∏–µ: –§–∞–∫—Ç–∏—á–µ—Å–∫–∏–π —Ä–∞–∑–º–µ—Ä —Ö—Ä–∞–Ω–∏–ª–∏—â–∞, –∑–∞–Ω–∏–º–∞–µ–º—ã–π –∫–æ–ª–ª–µ–∫—Ü–∏–µ–π.

16. mongodb_config_image_collection_stats_storageStats_totalIndexSize
–ï–¥–∏–Ω–∏—Ü–∞ –∏–∑–º–µ—Ä–µ–Ω–∏—è: –±–∞–π—Ç—ã (bytes)
–û–ø–∏—Å–∞–Ω–∏–µ: –û–±—â–∏–π —Ä–∞–∑–º–µ—Ä –≤—Å–µ—Ö –∏–Ω–¥–µ–∫—Å–æ–≤ –∫–æ–ª–ª–µ–∫—Ü–∏–∏. –ò–Ω–¥–µ–∫—Å—ã –º–æ–≥—É—Ç –∑–∞–Ω–∏–º–∞—Ç—å –∑–Ω–∞—á–∏—Ç–µ–ª—å–Ω–æ–µ –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–æ.

17. mongodb_config_image_collection_stats_storageStats_totalSize
–ï–¥–∏–Ω–∏—Ü–∞ –∏–∑–º–µ—Ä–µ–Ω–∏—è: –±–∞–π—Ç—ã (bytes)
–û–ø–∏—Å–∞–Ω–∏–µ: –û–±—â–∏–π —Ä–∞–∑–º–µ—Ä –¥–∞–Ω–Ω—ã—Ö –∏ –∏–Ω–¥–µ–∫—Å–æ–≤. –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏ –≤–∞–∂–Ω–æ –¥–ª—è –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –¥–∏—Å–∫–∞.

–ü–∞–Ω–µ–ª—å 6: –≠—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç—å –∏–Ω–¥–µ–∫—Å–æ–≤
18. mongodb_config_image_collection_stats_storageStats_nindexes
–ï–¥–∏–Ω–∏—Ü–∞ –∏–∑–º–µ—Ä–µ–Ω–∏—è: –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∏–Ω–¥–µ–∫—Å–æ–≤ (count)
–û–ø–∏—Å–∞–Ω–∏–µ: –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –∏–Ω–¥–µ–∫—Å–æ–≤ –≤ –∫–æ–ª–ª–µ–∫—Ü–∏–∏. –°–ª–∏—à–∫–æ–º –º–Ω–æ–≥–æ –∏–Ω–¥–µ–∫—Å–æ–≤ –º–æ–∂–µ—Ç –∑–∞–º–µ–¥–ª—è—Ç—å –∑–∞–ø–∏—Å—å.

19. mongodb_config_image_collection_stats_storageStats_indexDetails_id_btree_maximum_tree_depth
–ï–¥–∏–Ω–∏—Ü–∞ –∏–∑–º–µ—Ä–µ–Ω–∏—è: —É—Ä–æ–≤–Ω–∏ (levels)
–û–ø–∏—Å–∞–Ω–∏–µ: –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è –≥–ª—É–±–∏–Ω–∞ B-–¥–µ—Ä–µ–≤–∞ –∏–Ω–¥–µ–∫—Å–∞. –ë–æ–ª—å—à–∞—è –≥–ª—É–±–∏–Ω–∞ –º–æ–∂–µ—Ç —Å–Ω–∏–∂–∞—Ç—å –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –ø–æ–∏—Å–∫–∞.

20. mongodb_config_image_collection_stats_storageStats_indexSizes_id
–ï–¥–∏–Ω–∏—Ü–∞ –∏–∑–º–µ—Ä–µ–Ω–∏—è: –±–∞–π—Ç—ã (bytes)
–û–ø–∏—Å–∞–Ω–∏–µ: –†–∞–∑–º–µ—Ä –∏–Ω–¥–µ–∫—Å–∞ _id. –ë–∞–∑–æ–≤—ã–π –∏–Ω–¥–µ–∫—Å, –∫–æ—Ç–æ—Ä—ã–π –µ—Å—Ç—å –≤ –∫–∞–∂–¥–æ–π –∫–æ–ª–ª–µ–∫—Ü–∏–∏.

–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –ø–æ –Ω–∞—Å—Ç—Ä–æ–π–∫–µ –∞–ª–µ—Ä—Ç–∏–Ω–≥–∞:
–£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏—è –¥–ª—è:

–†–µ–∑–∫–æ–≥–æ —Ä–æ—Å—Ç–∞ mongodb_asserts_total (–±–æ–ª–µ–µ 1000/–º–∏–Ω)

–£–≤–µ–ª–∏—á–µ–Ω–∏—è –≤—Ä–µ–º–µ–Ω–∏ —Å–±–æ—Ä–∞ –º–µ—Ç—Ä–∏–∫ –±–æ–ª–µ–µ 500ms

–°–Ω–∏–∂–µ–Ω–∏—è —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏ –∫—ç—à–∞ (hit ratio –Ω–∏–∂–µ 90%)

–ë—ã—Å—Ç—Ä–æ–≥–æ —Ä–æ—Å—Ç–∞ —Ä–∞–∑–º–µ—Ä–∞ –¥–∞–Ω–Ω—ã—Ö –∏–ª–∏ –∏–Ω–¥–µ–∫—Å–æ–≤ (–±–æ–ª–µ–µ 10% –≤ —á–∞—Å)

–£–≤–µ–ª–∏—á–µ–Ω–∏—è –≤—Ä–µ–º–µ–Ω–∏ –ø–∞—É–∑ GC –±–æ–ª–µ–µ 100ms

–ù–∞—Å—Ç—Ä–æ–π—Ç–µ —Ä–∞–∑–Ω—ã–µ —É—Ä–æ–≤–Ω–∏ —Å–µ—Ä—å–µ–∑–Ω–æ—Å—Ç–∏ –¥–ª—è:

–ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏—Ö –º–µ—Ç—Ä–∏–∫ (asserts, –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –ø–∞–º—è—Ç–∏)

–ü—Ä–µ–¥—É–ø—Ä–µ–∂–¥–∞—é—â–∏—Ö –º–µ—Ç—Ä–∏–∫ (—Ä–∞–∑–º–µ—Ä –¥–∞–Ω–Ω—ã—Ö, —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç—å –∫—ç—à–∞)

–ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏–æ–Ω–Ω—ã—Ö –º–µ—Ç—Ä–∏–∫ (—Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è)

–¢–∞–∫–æ–π –¥–∞—à–±–æ—Ä–¥ –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–∏—Ç –∫–æ–º–ø–ª–µ–∫—Å–Ω–æ–µ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏–µ –æ —Å–æ—Å—Ç–æ—è–Ω–∏–∏ MongoDB –∏ –ø–æ–º–æ–∂–µ—Ç –±—ã—Å—Ç—Ä–æ –≤—ã—è–≤–ª—è—Ç—å –ø—Ä–æ–±–ª–µ–º—ã —Å –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å—é, –ø–∞–º—è—Ç—å—é, —Ö—Ä–∞–Ω–∏–ª–∏—â–µ–º –∏ —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç—å—é –∑–∞–ø—Ä–æ—Å–æ–≤.

node collector

–ì—Ä—É–ø–ø—ã –º–µ—Ç—Ä–∏–∫ –¥–ª—è –±–ª–æ–∫–æ–≤ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞ MongoDB —Å–µ—Ä–≤–µ—Ä–∞
1. –ë–ª–æ–∫: –û–±–∑–æ—Ä —Å–∏—Å—Ç–µ–º—ã (Overview)
–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ: –û–±—â–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ —Å–µ—Ä–≤–µ—Ä–∞ –∏ –∫–ª—é—á–µ–≤—ã–µ –ø–æ–∫–∞–∑–∞—Ç–µ–ª–∏

–ú–µ—Ç—Ä–∏–∫–∏:

node_load1, node_load5, node_load15 - –ó–∞–≥—Ä—É–∑–∫–∞ —Å–∏—Å—Ç–µ–º—ã

node_time_seconds - node_boot_time_seconds - Uptime —Å–∏—Å—Ç–µ–º—ã

node_network_up{device="eth0"} - –°—Ç–∞—Ç—É—Å —Å–µ—Ç–µ–≤–æ–≥–æ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞

2. –ë–ª–æ–∫: –ü—Ä–æ—Ü–µ—Å—Å–æ—Ä (CPU)
–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ: –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –∑–∞–≥—Ä—É–∑–∫–∏ –ø—Ä–æ—Ü–µ—Å—Å–æ—Ä–∞ –∏ —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏

–ú–µ—Ç—Ä–∏–∫–∏:

100 - (avg by(instance)(rate(node_cpu_seconds_total{mode="idle"}[5m])) * 100) - % –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è CPU

rate(node_cpu_seconds_total{mode="user"}[5m]) - CPU time –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏—Ö –ø—Ä–æ—Ü–µ—Å—Å–æ–≤

rate(node_cpu_seconds_total{mode="system"}[5m]) - CPU time —Å–∏—Å—Ç–µ–º–Ω—ã—Ö –ø—Ä–æ—Ü–µ—Å—Å–æ–≤

rate(node_context_switches_total[5m]) - –ö–æ–Ω—Ç–µ–∫—Å—Ç–Ω—ã–µ –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏—è

üîπ –î–ª—è capacity planning:

rate(node_cpu_seconds_total{mode="idle"}[24h]) - –¢—Ä–µ–Ω–¥ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è CPU

node_cpu_seconds_total{mode="user"} - –û–±—â–∞—è –Ω–∞–≥—Ä—É–∑–∫–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏—Ö –ø—Ä–æ—Ü–µ—Å—Å–æ–≤

3. –ë–ª–æ–∫: –ü–∞–º—è—Ç—å (Memory)
–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ: –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –æ–ø–µ—Ä–∞—Ç–∏–≤–Ω–æ–π –ø–∞–º—è—Ç–∏

–ú–µ—Ç—Ä–∏–∫–∏:

node_memory_MemTotal_bytes - node_memory_MemAvailable_bytes - –ò—Å–ø–æ–ª—å–∑—É–µ–º–∞—è –ø–∞–º—è—Ç—å

(node_memory_MemTotal_bytes - node_memory_MemAvailable_bytes) / node_memory_MemTotal_bytes * 100 - % –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –ø–∞–º—è—Ç–∏

node_memory_Cached_bytes - –ö—ç—à–∏—Ä–æ–≤–∞–Ω–Ω–∞—è –ø–∞–º—è—Ç—å

node_memory_Buffers_bytes - –ë—É—Ñ–µ—Ä—ã –ø–∞–º—è—Ç–∏

üîπ –î–ª—è capacity planning:

node_memory_MemTotal_bytes - –û–±—â–∏–π –æ–±—ä–µ–º –ø–∞–º—è—Ç–∏

node_memory_MemAvailable_bytes - –î–æ—Å—Ç—É–ø–Ω–∞—è –ø–∞–º—è—Ç—å (—Ç—Ä–µ–Ω–¥ —É–º–µ–Ω—å—à–µ–Ω–∏—è)

rate(node_memory_Active_bytes[24h]) - –†–æ—Å—Ç –∞–∫—Ç–∏–≤–Ω–æ–π –ø–∞–º—è—Ç–∏

4. –ë–ª–æ–∫: –î–∏—Å–∫–æ–≤–∞—è –ø–æ–¥—Å–∏—Å—Ç–µ–º–∞ (Storage)
–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ: –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ –∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –¥–∏—Å–∫–æ–≤

–ú–µ—Ç—Ä–∏–∫–∏:

node_filesystem_size_bytes{mountpoint="/"} - node_filesystem_free_bytes{mountpoint="/"} - –ò—Å–ø–æ–ª—å–∑—É–µ–º–æ–µ –º–µ—Å—Ç–æ

node_filesystem_avail_bytes{mountpoint="/"} / node_filesystem_size_bytes{mountpoint="/"} * 100 - % —Å–≤–æ–±–æ–¥–Ω–æ–≥–æ –º–µ—Å—Ç–∞

rate(node_disk_reads_completed_total{device="sda"}[5m]) - IOPS —á—Ç–µ–Ω–∏—è

rate(node_disk_writes_completed_total{device="sda"}[5m]) - IOPS –∑–∞–ø–∏—Å–∏

üîπ –î–ª—è capacity planning:

node_filesystem_size_bytes{mountpoint="/"} - –û–±—â–∏–π —Ä–∞–∑–º–µ—Ä —Ñ–∞–π–ª–æ–≤–æ–π —Å–∏—Å—Ç–µ–º—ã

node_filesystem_avail_bytes{mountpoint="/"} - –°–≤–æ–±–æ–¥–Ω–æ–µ –º–µ—Å—Ç–æ (—Ç—Ä–µ–Ω–¥ —É–º–µ–Ω—å—à–µ–Ω–∏—è)

rate(node_disk_written_bytes_total{device="sda"}[24h]) - –°–∫–æ—Ä–æ—Å—Ç—å —Ä–æ—Å—Ç–∞ –¥–∞–Ω–Ω—ã—Ö

rate(node_disk_read_bytes_total{device="sda"}[24h]) - –ò–Ω—Ç–µ–Ω—Å–∏–≤–Ω–æ—Å—Ç—å —á—Ç–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö

5. –ë–ª–æ–∫: –°–µ—Ç—å (Network)
–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ: –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ —Å–µ—Ç–µ–≤–æ–π –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏

–ú–µ—Ç—Ä–∏–∫–∏:

rate(node_network_receive_bytes_total{device="eth0"}[5m]) * 8 - –í—Ö–æ–¥—è—â–∏–π —Ç—Ä–∞—Ñ–∏–∫ (–±–∏—Ç/—Å)

rate(node_network_transmit_bytes_total{device="eth0"}[5m]) * 8 - –ò—Å—Ö–æ–¥—è—â–∏–π —Ç—Ä–∞—Ñ–∏–∫ (–±–∏—Ç/—Å)

rate(node_network_receive_packets_total{device="eth0"}[5m]) - –í—Ö–æ–¥—è—â–∏–µ –ø–∞–∫–µ—Ç—ã/—Å–µ–∫

üîπ –î–ª—è capacity planning:

increase(node_network_receive_bytes_total{device="eth0"}[24h]) - –°—É—Ç–æ—á–Ω—ã–π –æ–±—ä–µ–º –≤—Ö–æ–¥—è—â–µ–≥–æ —Ç—Ä–∞—Ñ–∏–∫–∞

increase(node_network_transmit_bytes_total{device="eth0"}[24h]) - –°—É—Ç–æ—á–Ω—ã–π –æ–±—ä–µ–º –∏—Å—Ö–æ–¥—è—â–µ–≥–æ —Ç—Ä–∞—Ñ–∏–∫–∞

rate(node_network_receive_bytes_total{device="eth0"}[7d]) - –ù–µ–¥–µ–ª—å–Ω—ã–π —Ç—Ä–µ–Ω–¥ —Å–µ—Ç–µ–≤–æ–π –Ω–∞–≥—Ä—É–∑–∫–∏

6. –ë–ª–æ–∫: –ü—Ä–æ—Ü–µ—Å—Å—ã –∏ —Ñ–∞–π–ª–æ–≤—ã–µ –¥–µ—Å–∫—Ä–∏–ø—Ç–æ—Ä—ã
–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ: –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ —Å–∏—Å—Ç–µ–º–Ω—ã—Ö –ø—Ä–æ—Ü–µ—Å—Å–æ–≤ –∏ –ª–∏–º–∏—Ç–æ–≤

–ú–µ—Ç—Ä–∏–∫–∏:

node_procs_running - –í—ã–ø–æ–ª–Ω—è—é—â–∏–µ—Å—è –ø—Ä–æ—Ü–µ—Å—Å—ã

node_filefd_allocated - –ò—Å–ø–æ–ª—å–∑—É–µ–º—ã–µ —Ñ–∞–π–ª–æ–≤—ã–µ –¥–µ—Å–∫—Ä–∏–ø—Ç–æ—Ä—ã

node_filefd_allocated / node_filefd_maximum * 100 - % –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è —Ñ–∞–π–ª–æ–≤—ã—Ö –¥–µ—Å–∫—Ä–∏–ø—Ç–æ—Ä–æ–≤

üîπ –î–ª—è capacity planning:

node_filefd_allocated - –¢—Ä–µ–Ω–¥ —Ä–æ—Å—Ç–∞ —Ñ–∞–π–ª–æ–≤—ã—Ö –¥–µ—Å–∫—Ä–∏–ø—Ç–æ—Ä–æ–≤

node_filefd_maximum - –ú–∞–∫—Å–∏–º–∞–ª—å–Ω—ã–π –ª–∏–º–∏—Ç –¥–µ—Å–∫—Ä–∏–ø—Ç–æ—Ä–æ–≤

rate(node_forks_total[24h]) - –ò–Ω—Ç–µ–Ω—Å–∏–≤–Ω–æ—Å—Ç—å —Å–æ–∑–¥–∞–Ω–∏—è –ø—Ä–æ—Ü–µ—Å—Å–æ–≤

7. –ë–ª–æ–∫: –î–∞–≤–ª–µ–Ω–∏–µ —Ä–µ—Å—É—Ä—Å–æ–≤ (Pressure)
–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ: –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –∑–∞–¥–µ—Ä–∂–µ–∫ –∏ contention

–ú–µ—Ç—Ä–∏–∫–∏:

rate(node_pressure_cpu_waiting_seconds_total[5m]) - –í—Ä–µ–º—è –æ–∂–∏–¥–∞–Ω–∏—è CPU

rate(node_pressure_io_waiting_seconds_total[5m]) - –í—Ä–µ–º—è –æ–∂–∏–¥–∞–Ω–∏—è I/O

rate(node_pressure_io_stalled_seconds_total[5m]) - –í—Ä–µ–º—è –ø—Ä–æ—Å—Ç–æ—è –∏–∑-–∑–∞ I/O

üîπ –î–ª—è capacity planning:

increase(node_pressure_io_waiting_seconds_total[7d]) - –ù–µ–¥–µ–ª—å–Ω—ã–π —Ä–æ—Å—Ç –≤—Ä–µ–º–µ–Ω–∏ –æ–∂–∏–¥–∞–Ω–∏—è I/O

increase(node_pressure_cpu_waiting_seconds_total[7d]) - –ù–µ–¥–µ–ª—å–Ω—ã–π —Ä–æ—Å—Ç –≤—Ä–µ–º–µ–Ω–∏ –æ–∂–∏–¥–∞–Ω–∏—è CPU

8. –ë–ª–æ–∫: –ö–ª—é—á–µ–≤—ã–µ –º–µ—Ç—Ä–∏–∫–∏ –¥–ª—è capacity planning
üìä –û—Å–Ω–æ–≤–Ω—ã–µ –º–µ—Ç—Ä–∏–∫–∏ –¥–ª—è –ø–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏—è —Ä–µ—Å—É—Ä—Å–æ–≤:

–ü–∞–º—è—Ç—å:

node_memory_MemAvailable_bytes - –¢—Ä–µ–Ω–¥ –¥–æ—Å—Ç—É–ø–Ω–æ–π –ø–∞–º—è—Ç–∏

node_memory_Active_bytes - –†–æ—Å—Ç –∞–∫—Ç–∏–≤–Ω–æ–π –ø–∞–º—è—Ç–∏

–î–∏—Å–∫–æ–≤–æ–µ –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–æ:

node_filesystem_avail_bytes{mountpoint="/"} - –°–∫–æ—Ä–æ—Å—Ç—å —É–º–µ–Ω—å—à–µ–Ω–∏—è —Å–≤–æ–±–æ–¥–Ω–æ–≥–æ –º–µ—Å—Ç–∞

increase(node_disk_written_bytes_total[7d]) - –ù–µ–¥–µ–ª—å–Ω—ã–π –ø—Ä–∏—Ä–æ—Å—Ç –¥–∞–Ω–Ω—ã—Ö

–°–µ—Ç—å:

increase(node_network_receive_bytes_total[30d]) - –ú–µ—Å—è—á–Ω—ã–π —Ä–æ—Å—Ç —Ç—Ä–∞—Ñ–∏–∫–∞

rate(node_network_receive_bytes_total[7d]) - –¢—Ä–µ–Ω–¥ —Å–µ—Ç–µ–≤–æ–π –Ω–∞–≥—Ä—É–∑–∫–∏

–ü—Ä–æ—Ü–µ—Å—Å–æ—Ä:

rate(node_cpu_seconds_total{mode="user"}[30d]) - –ú–µ—Å—è—á–Ω—ã–π —Ç—Ä–µ–Ω–¥ –Ω–∞–≥—Ä—É–∑–∫–∏

node_cpu_seconds_total{mode="idle"} - –û–±—â–µ–µ –≤—Ä–µ–º—è –ø—Ä–æ—Å—Ç–æ—è (–¥–ª—è —Ä–∞—Å—á–µ—Ç–∞ —É—Ç–∏–ª–∏–∑–∞—Ü–∏–∏)

–§–∞–π–ª–æ–≤—ã–µ –¥–µ—Å–∫—Ä–∏–ø—Ç–æ—Ä—ã:

node_filefd_allocated - –¢—Ä–µ–Ω–¥ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

node_filefd_maximum - –ü—Ä–µ–¥–µ–ª—å–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ

–≠—Ç–∏ –º–µ—Ç—Ä–∏–∫–∏ –ø–æ–∑–≤–æ–ª—è—é—Ç –ø—Ä–æ–≥–Ω–æ–∑–∏—Ä–æ–≤–∞—Ç—å:

–ö–æ–≥–¥–∞ –ø–æ—Ç—Ä–µ–±—É–µ—Ç—Å—è –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ –ø–∞–º—è—Ç–∏

–°—Ä–æ–∫ –∏—Å—á–µ—Ä–ø–∞–Ω–∏—è –¥–∏—Å–∫–æ–≤–æ–≥–æ –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–∞

–ù–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç—å —É–≤–µ–ª–∏—á–µ–Ω–∏—è —Å–µ—Ç–µ–≤–æ–π –ø—Ä–æ–ø—É—Å–∫–Ω–æ–π —Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç–∏

–ü–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ –∞–ø–≥—Ä–µ–π–¥–∞ CPU

–ù–∞—Å—Ç—Ä–æ–π–∫—É –ª–∏–º–∏—Ç–æ–≤ —Ñ–∞–π–ª–æ–≤—ã—Ö –¥–µ—Å–∫—Ä–∏–ø—Ç–æ—Ä–æ–≤
