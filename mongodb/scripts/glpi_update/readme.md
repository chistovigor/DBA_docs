Inventory export to CSV_gsheets script

ðŸŽ¯ ÐÐ°Ð·Ð½Ð°Ñ‡ÐµÐ½Ð¸Ðµ

Ð¡ÐºÑ€Ð¸Ð¿Ñ‚ Ð°Ð²Ñ‚Ð¾Ð¼Ð°Ñ‚Ð¸Ð·Ð¸Ñ€ÑƒÐµÑ‚ ÑÐ¾Ð·Ð´Ð°Ð½Ð¸Ðµ Ð¾Ñ‚Ñ‡Ñ‘Ñ‚Ð° Ð¸Ð· Ð¸ÑÑ…Ð¾Ð´Ð½Ð¾Ð³Ð¾ Google Spreadsheet:

Ð‘ÐµÑ€Ñ‘Ñ‚ Ð´Ð°Ð½Ð½Ñ‹Ðµ Ñ ÑƒÐºÐ°Ð·Ð°Ð½Ð½Ð¾Ð³Ð¾ Ð»Ð¸ÑÑ‚Ð°.

ÐŸÑ€Ð¾Ð¿ÑƒÑÐºÐ°ÐµÑ‚ Ð¿ÐµÑ€Ð²ÑƒÑŽ ÑÑ‚Ñ€Ð¾ÐºÑƒ (ÐµÑÐ»Ð¸ Ð¾Ð±ÑŠÐµÐ´Ð¸Ð½ÐµÐ½Ð°).

ÐšÐ¾Ð¿Ð¸Ñ€ÑƒÐµÑ‚ Ñ‚Ð¾Ð»ÑŒÐºÐ¾ Ð¾Ð¿Ñ€ÐµÐ´ÐµÐ»Ñ‘Ð½Ð½Ñ‹Ðµ ÑÑ‚Ð¾Ð»Ð±Ñ†Ñ‹.

Ð¡Ð¾Ð·Ð´Ð°Ñ‘Ñ‚ Ð¸Ð»Ð¸ Ð¾Ð±Ð½Ð¾Ð²Ð»ÑÐµÑ‚ Ð´Ð¾ÐºÑƒÐ¼ÐµÐ½Ñ‚ mongo_servers_csv.

Ð”Ð¾Ð±Ð°Ð²Ð»ÑÐµÑ‚ Ð² Ð½ÐµÐ³Ð¾ Ð½Ð¾Ð²Ñ‹Ð¹ Ð»Ð¸ÑÑ‚ Ñ Ð¼ÐµÑ‚ÐºÐ¾Ð¹ Ð²Ñ€ÐµÐ¼ÐµÐ½Ð¸.

ÐŸÐ¾Ð´ÑÐ²ÐµÑ‡Ð¸Ð²Ð°ÐµÑ‚ Ð½Ð¾Ð²Ñ‹Ðµ Ñ€Ð°Ð·Ð»Ð¸Ñ‡Ð¸Ñ Ð¼ÐµÐ¶Ð´Ñƒ Ð²Ñ‹Ð³Ñ€ÑƒÐ·ÐºÐ°Ð¼Ð¸.

Ð£Ð´Ð°Ð»ÑÐµÑ‚ ÑÑ‚Ð°Ñ€Ñ‹Ðµ Ð»Ð¸ÑÑ‚Ñ‹ (ÐµÑÐ»Ð¸ Ð¸Ñ… Ð±Ð¾Ð»ÑŒÑˆÐµ 24).

Ð¡Ð¾Ð·Ð´Ð°Ñ‘Ñ‚ CSV-Ñ„Ð°Ð¹Ð» Ð² Google Drive Ñ Ð¸Ð¼ÐµÐ½ÐµÐ¼ mongo_servers_YYYY-MM-DD_HH-mm.csv.

Ð’ÑÑ‚Ð°Ð²Ð»ÑÐµÑ‚ ÑÑÑ‹Ð»ÐºÑƒ Ð½Ð° ÑÐºÐ°Ñ‡Ð¸Ð²Ð°Ð½Ð¸Ðµ CSV Ð² Ð»Ð¸ÑÑ‚ inventory_updates Ð¸ÑÑ…Ð¾Ð´Ð½Ð¾Ð³Ð¾ Ñ„Ð°Ð¹Ð»Ð°.

âš™ï¸ ÐŸÐ°Ñ€Ð°Ð¼ÐµÑ‚Ñ€Ñ‹ ÐºÐ¾Ð½Ñ„Ð¸Ð³ÑƒÑ€Ð°Ñ†Ð¸Ð¸
ÐŸÐ°Ñ€Ð°Ð¼ÐµÑ‚Ñ€	ÐÐ°Ð·Ð½Ð°Ñ‡ÐµÐ½Ð¸Ðµ	ÐŸÑ€Ð¸Ð¼ÐµÑ€
sourceFileId	ID Ð¸ÑÑ…Ð¾Ð´Ð½Ð¾Ð³Ð¾ Spreadsheet (Ð¼Ð¾Ð¶Ð½Ð¾ Ð¾ÑÑ‚Ð°Ð²Ð¸Ñ‚ÑŒ "SOURCE_SPREADSHEET_ID" â€” Ñ‚Ð¾Ð³Ð´Ð° Ð¸ÑÐ¿Ð¾Ð»ÑŒÐ·ÑƒÐµÑ‚ÑÑ Ñ‚ÐµÐºÑƒÑ‰Ð¸Ð¹ Ð´Ð¾ÐºÑƒÐ¼ÐµÐ½Ñ‚)	"1abcXYZ..."
sourceSheetName	Ð˜Ð¼Ñ Ð»Ð¸ÑÑ‚Ð°, Ð¸Ð· ÐºÐ¾Ñ‚Ð¾Ñ€Ð¾Ð³Ð¾ ÐºÐ¾Ð¿Ð¸Ñ€ÑƒÑŽÑ‚ÑÑ Ð´Ð°Ð½Ð½Ñ‹Ðµ	"Sheet1"
updateSheetName	Ð˜Ð¼Ñ Ð»Ð¸ÑÑ‚Ð°, ÐºÑƒÐ´Ð° Ð´Ð¾Ð±Ð°Ð²Ð»ÑÐµÑ‚ÑÑ ÑÑÑ‹Ð»ÐºÐ° Ð½Ð° CSV	"inventory_updates"
maxSheets	ÐœÐ°ÐºÑÐ¸Ð¼Ð°Ð»ÑŒÐ½Ð¾Ðµ ÐºÐ¾Ð»Ð¸Ñ‡ÐµÑÑ‚Ð²Ð¾ Ð»Ð¸ÑÑ‚Ð¾Ð², Ñ…Ñ€Ð°Ð½Ð¸Ð¼Ñ‹Ñ… Ð² mongo_servers_csv	24
columnOrder	ÐÐ¾Ð²Ñ‹Ð¹ Ð¿Ð¾Ñ€ÑÐ´Ð¾Ðº ÑÑ‚Ð¾Ð»Ð±Ñ†Ð¾Ð² (Ð¸Ð½Ð´ÐµÐºÑÐ°Ñ†Ð¸Ñ Ñ 0)	[3, 1, 2, 5]
ðŸ—“ï¸ Ð¤Ð¾Ñ€Ð¼Ð¸Ñ€Ð¾Ð²Ð°Ð½Ð¸Ðµ Ð²Ñ€ÐµÐ¼ÐµÐ½Ð½Ð¾Ð³Ð¾ ÑˆÑ‚Ð°Ð¼Ð¿Ð°

Ð˜ÑÐ¿Ð¾Ð»ÑŒÐ·ÑƒÐµÑ‚ÑÑ Ñ„Ð¾Ñ€Ð¼Ð°Ñ‚:

YYYY-MM-DD_HH-mm


Ð¿Ñ€Ð¸Ð¼ÐµÑ€: 2025-10-09_12-10
â€” Ð±ÐµÐ· ÑÐµÐºÑƒÐ½Ð´, Ñ‡Ñ‚Ð¾Ð±Ñ‹ Ð½Ðµ ÑÐ¾Ð·Ð´Ð°Ð²Ð°Ñ‚ÑŒ ÑÐ»Ð¸ÑˆÐºÐ¾Ð¼ Ð¼Ð½Ð¾Ð³Ð¾ Ð»Ð¸ÑÑ‚Ð¾Ð² Ð¿Ñ€Ð¸ Ñ‡Ð°ÑÑ‚Ð¾Ð¼ Ð·Ð°Ð¿ÑƒÑÐºÐµ.

ðŸŸ¨ Ð›Ð¾Ð³Ð¸ÐºÐ° Ð¿Ð¾Ð´ÑÐ²ÐµÑ‚ÐºÐ¸

Ð¡Ñ€Ð°Ð²Ð½Ð¸Ð²Ð°ÑŽÑ‚ÑÑ ÑÑ‡ÐµÐ¹ÐºÐ¸:

ÐµÑÐ»Ð¸ Ð·Ð½Ð°Ñ‡ÐµÐ½Ð¸Ðµ Ð¸Ð·Ð¼ÐµÐ½Ð¸Ð»Ð¾ÑÑŒ Ð¿Ð¾ ÑÑ€Ð°Ð²Ð½ÐµÐ½Ð¸ÑŽ Ñ Ð¿Ñ€ÐµÐ´Ñ‹Ð´ÑƒÑ‰Ð¸Ð¼ Ð»Ð¸ÑÑ‚Ð¾Ð¼,

Ð¸ ÑÑ‚Ð¾ Ð¸Ð·Ð¼ÐµÐ½ÐµÐ½Ð¸Ðµ Ð½Ðµ ÑÐ¾Ð²Ð¿Ð°Ð´Ð°ÐµÑ‚ Ñ Ð¿Ñ€ÐµÐ´Ñ‹Ð´ÑƒÑ‰Ð¸Ð¼Ð¸ Ð¸Ð·Ð¼ÐµÐ½ÐµÐ½Ð¸ÑÐ¼Ð¸ (Ñ‚.Ðµ. Ð½Ðµ Ð±Ñ‹Ð»Ð¾ ÑƒÐ¶Ðµ Ð·Ð°Ñ„Ð¸ÐºÑÐ¸Ñ€Ð¾Ð²Ð°Ð½Ð¾ Ñ€Ð°Ð½ÐµÐµ),
Ñ‚Ð¾ ÑÑ‡ÐµÐ¹ÐºÐ° Ð¿Ð¾Ð´ÑÐ²ÐµÑ‡Ð¸Ð²Ð°ÐµÑ‚ÑÑ Ð¶Ñ‘Ð»Ñ‚Ñ‹Ð¼ Ñ†Ð²ÐµÑ‚Ð¾Ð¼.

ðŸ’¾ CSV ÑÐºÑÐ¿Ð¾Ñ€Ñ‚

ÐŸÐ¾ÑÐ»Ðµ ÑÐ¾Ð·Ð´Ð°Ð½Ð¸Ñ Ð½Ð¾Ð²Ð¾Ð³Ð¾ Ð»Ð¸ÑÑ‚Ð°:

Ñ„Ð¾Ñ€Ð¼Ð¸Ñ€ÑƒÐµÑ‚ÑÑ CSV-Ñ„Ð°Ð¹Ð» Ñ Ð¸Ð¼ÐµÐ½ÐµÐ¼:
mongo_servers_2025-10-09_12-10.csv

Ñ„Ð°Ð¹Ð» ÑÐ¾Ñ…Ñ€Ð°Ð½ÑÐµÑ‚ÑÑ Ð² Google Drive;

ÑÐ¾Ð·Ð´Ð°Ñ‘Ñ‚ÑÑ Ð¿Ñ€ÑÐ¼Ð°Ñ ÑÑÑ‹Ð»ÐºÐ° Ð½Ð° ÑÐºÐ°Ñ‡Ð¸Ð²Ð°Ð½Ð¸Ðµ, Ð²Ð¸Ð´Ð°:

https://drive.google.com/uc?export=download&id=FILE_ID


ÑÑÑ‹Ð»ÐºÐ° Ð´Ð¾Ð±Ð°Ð²Ð»ÑÐµÑ‚ÑÑ Ð² ÑÑ‚Ð¾Ð»Ð±ÐµÑ† A Ð»Ð¸ÑÑ‚Ð° inventory_updates.

ðŸ§­ ÐšÐ°Ðº Ð·Ð°Ð¿ÑƒÑÑ‚Ð¸Ñ‚ÑŒ

ÐžÑ‚ÐºÑ€Ð¾Ð¹ Google Spreadsheet Ñ Ð¸ÑÑ…Ð¾Ð´Ð½Ñ‹Ð¼Ð¸ Ð´Ð°Ð½Ð½Ñ‹Ð¼Ð¸.

Ð’ Ð¼ÐµÐ½ÑŽ Ð²Ñ‹Ð±ÐµÑ€Ð¸ Ð Ð°ÑÑˆÐ¸Ñ€ÐµÐ½Ð¸Ñ â†’ Apps Script.

Ð’ÑÑ‚Ð°Ð²ÑŒ ÐºÐ¾Ð´ Ð¿Ð¾Ð»Ð½Ð¾ÑÑ‚ÑŒÑŽ.

Ð¡Ð¾Ñ…Ñ€Ð°Ð½Ð¸ Ð¿Ñ€Ð¾ÐµÐºÑ‚.

ÐŸÐµÑ€Ð²Ñ‹Ð¹ Ñ€Ð°Ð· Ð¿Ñ€Ð¸ Ð·Ð°Ð¿ÑƒÑÐºÐµ Ñ€Ð°Ð·Ñ€ÐµÑˆÐ¸ Ð´Ð¾ÑÑ‚ÑƒÐ¿ (OAuth).

ÐŸÐ¾ÑÐ»Ðµ ÑÑ‚Ð¾Ð³Ð¾ Ð² Ð¼ÐµÐ½ÑŽ Ñ‚Ð°Ð±Ð»Ð¸Ñ†Ñ‹ Ð¿Ð¾ÑÐ²Ð¸Ñ‚ÑÑ Ð½Ð¾Ð²Ñ‹Ð¹ Ð¿ÑƒÐ½ÐºÑ‚:
ðŸ“¥ Ð­ÐºÑÐ¿Ð¾Ñ€Ñ‚ Mongo â†’ Ð¡Ð¾Ð·Ð´Ð°Ñ‚ÑŒ Ñ„Ð°Ð¹Ð» Ð¸ Ð¿Ð¾Ð»ÑƒÑ‡Ð¸Ñ‚ÑŒ CSV

ðŸ§¹ ÐžÑ‡Ð¸ÑÑ‚ÐºÐ°

ÐŸÑ€Ð¸ Ð¿Ñ€ÐµÐ²Ñ‹ÑˆÐµÐ½Ð¸Ð¸ Ð»Ð¸Ð¼Ð¸Ñ‚Ð° maxSheets ÑÑ‚Ð°Ñ€Ñ‹Ðµ Ð»Ð¸ÑÑ‚Ñ‹ (ÑÐ°Ð¼Ñ‹Ðµ Ñ€Ð°Ð½Ð½Ð¸Ðµ Ð¿Ð¾ Ð¸Ð¼ÐµÐ½Ð¸) Ð°Ð²Ñ‚Ð¾Ð¼Ð°Ñ‚Ð¸Ñ‡ÐµÑÐºÐ¸ ÑƒÐ´Ð°Ð»ÑÑŽÑ‚ÑÑ.

Run python script after for glpi update:

python3 glpi_set_notes.py mongo_servers_2025-10-09_12-10.csv > glpi_set_notes.py.log_20251008_10

mongo_servers_2025-10-09_12-10.csv - uploaded csv (see above)
glpi_set_notes.py.log_20251008_10 - execution log (see run results inside)